\documentclass[aspectratio=169, 11pt]{beamer}

% ======================================================================
% THEME & STYLING
% ======================================================================
\usetheme{Madrid}
\usecolortheme{default}
\usefonttheme{professionalfonts}

% -- Couleurs --
\definecolor{soapblue}{HTML}{1565C0}
\definecolor{restgreen}{HTML}{2E7D32}
\definecolor{graphqlpurple}{HTML}{7B1FA2}
\definecolor{grpcorange}{HTML}{E65100}
\definecolor{darkbg}{HTML}{1A1A2E}
\definecolor{accentblue}{HTML}{0F4C81}

\setbeamercolor{palette primary}{bg=accentblue, fg=white}
\setbeamercolor{palette secondary}{bg=accentblue!80, fg=white}
\setbeamercolor{palette tertiary}{bg=accentblue!60, fg=white}
\setbeamercolor{structure}{fg=accentblue}
\setbeamercolor{title}{fg=white}
\setbeamercolor{frametitle}{fg=accentblue, bg=white}
\setbeamercolor{block title}{bg=accentblue, fg=white}
\setbeamercolor{block body}{bg=accentblue!5, fg=black}
\setbeamercolor{item}{fg=accentblue}
\setbeamercolor{footline}{fg=gray}

\setbeamertemplate{navigation symbols}{}
\setbeamertemplate{footline}{%
  \leavevmode\hbox{%
    \begin{beamercolorbox}[wd=.5\paperwidth,ht=2.5ex,dp=1ex,left]{footline}%
      \hspace{1em}\scriptsize RetailSync -- Comparaison d'APIs
    \end{beamercolorbox}%
    \begin{beamercolorbox}[wd=.5\paperwidth,ht=2.5ex,dp=1ex,right]{footline}%
      \scriptsize\insertframenumber\,/\,\inserttotalframenumber\hspace{1em}
    \end{beamercolorbox}%
  }%
}

% -- Packages --
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{array}
\usepackage{colortbl}
\usepackage{xcolor}
\usepackage{tikz}
\usepackage{hyperref}

\graphicspath{{../diagrams/}}

% -- Custom commands --
\newcommand{\soapbadge}{\colorbox{soapblue}{\textcolor{white}{\scriptsize\textbf{~SOAP~}}}}
\newcommand{\restbadge}{\colorbox{restgreen}{\textcolor{white}{\scriptsize\textbf{~REST~}}}}
\newcommand{\graphqlbadge}{\colorbox{graphqlpurple}{\textcolor{white}{\scriptsize\textbf{~GraphQL~}}}}
\newcommand{\grpcbadge}{\colorbox{grpcorange}{\textcolor{white}{\scriptsize\textbf{~gRPC~}}}}

\newcommand{\gained}[1]{\textcolor{restgreen}{\textbf{+}}~#1}
\newcommand{\sacrificed}[1]{\textcolor{red!70!black}{\textbf{--}}~#1}

% ======================================================================
% DOCUMENT
% ======================================================================
\title[Comparaison d'Architectures API]{\textbf{Étude Comparative d'Architectures API}}
\subtitle{Modélisation d'un Système d'Information Retail Omnicanal\\Approche par Microservices : SOAP, REST, GraphQL et gRPC}
\author{Soutenance de Projet - Architecture Logicielle}
\date{}
\institute{}

\begin{document}

% ======================================================================
% TITLE
% ======================================================================
\begin{frame}[plain]
  \maketitle
\end{frame}

% ======================================================================
% AGENDA
% ======================================================================
\begin{frame}{Plan de la présentation}
  \begin{enumerate}
    \item \textbf{Contexte Fonctionnel} -- Définition des besoins métier \hfill \textit{2 min}
    \item \textbf{Choix Architectural} -- Justification de l'approche Microservices \hfill \textit{3 min}
    \item \textbf{Analyse des Services et Protocoles} -- SOAP, REST, GraphQL, gRPC \hfill \textit{6 min}
    \item \textbf{Étude Comparative} -- Performance et cas d'usage \hfill \textit{5 min}
    \item \textbf{Conclusion et Améliorations} -- API Gateway \hfill \textit{2 min}
  \end{enumerate}
  \vfill
  \centering
  \soapbadge\quad \restbadge\quad \graphqlbadge\quad \grpcbadge
\end{frame}

% ======================================================================
% SECTION 1: CONTEXT
% ======================================================================
\section{1. Contexte Fonctionnel}

\begin{frame}{Modélisation du Système d'Information (Retail)}
  Modélisation du SI d'une entreprise (Retail), caractérisé par des flux hétérogènes entre \textbf{quatre domaines métiers distincts} :
  \vspace{0.3em}
  \begin{columns}[T]
    \begin{column}{0.48\textwidth}
      \begin{block}{\soapbadge~Domaine 1 : Approvisionnement}
        Création de bons de commande vers des fournisseurs industriels (ERP historiques).
      \end{block}
      \begin{block}{\graphqlbadge~Domaine 3 : Pilotage}
        Vue consolidée (Tableau de bord) des stocks, commandes et logistique pour la direction.
      \end{block}
    \end{column}
    \begin{column}{0.48\textwidth}
      \begin{block}{\restbadge~Domaine 2 : Réseau de Boutiques}
        Boutiques partenaires synchronisant leurs niveaux de stock avec le siège central.
      \end{block}
      \begin{block}{\grpcbadge~Domaine 4 : Logistique Entrepôt}
        Télémétrie très haute fréquence issue de la flotte de robots d'automatisation.
      \end{block}
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}{Démarche d'Ingénierie : Approche "Contract-First"}
  \begin{columns}[T]
    \begin{column}{0.55\textwidth}
      La conception du SI a suivi une méthode stricte d'ingénierie dirigée par les contrats :
      \begin{enumerate}
        \item \textbf{Spécification du Contrat} -- Définition formelle de l'interface avant toute implémentation.
        \item \textbf{Génération/Implémentation} -- Le serveur est contraint par les stubs et schémas générés à partir du contrat.
        \item \textbf{Validation} -- Vérification systématique de la conformité des échanges.
      \end{enumerate}
    \end{column}
    \begin{column}{0.42\textwidth}
      \begin{table}
        \centering
        \scriptsize
        \begin{tabular}{ll}
          \toprule
          \textbf{Module} & \textbf{Le fichier Contrat} \\
          \midrule
          \textcolor{soapblue}{SOAP} & \texttt{PurchaseOrder.wsdl} \\
          \textcolor{restgreen}{REST} & \texttt{openapi.yaml} \\
          \textcolor{graphqlpurple}{GraphQL} & \texttt{schema.graphql} \\
          \textcolor{grpcorange}{gRPC} & \texttt{warehouse.proto} \\
          \bottomrule
        \end{tabular}
      \end{table}
      \vspace{0.5em}
      \begin{alertblock}{Bénéfice Architectural}
        Le découplage entre la spécification (contrat) et l'implémentation (code) favorise l'indépendance des équipes et la robustesse des systèmes distribués.
      \end{alertblock}
    \end{column}
  \end{columns}
\end{frame}

% ======================================================================
% SECTION 2: ARCHITECTURE
% ======================================================================
\section{2. Choix Architectural}

\begin{frame}{Justification de l'approche Microservices}
  Face à l'hétérogénéité des besoins métier, une architecture monolithique a été rejetée au profit d'une **architecture orientée Microservices**.
  
  \vspace{0.5em}
  
  \textbf{Raisonnement : Pourquoi segmenter en services distincts ?}
  \begin{itemize}
    \item \textbf{Contraintes Technologiques Incompatibles :} gRPC (HTTP/2 binaire), SOAP (Spécifications XML lourdes) et REST (HTTP/1.1 classique) nécessitent des bibliothèques et des serveurs sous-jacents structurellement différents. Une fusion créerait une dépendance forte et complexe ("anti-pattern").
    \item \textbf{Isolation des Défaillances :} Une surcharge sur le service de télémétrie des robots (gRPC) ne doit pas impacter la création des bons de commande (SOAP). L'isolation par processus métier garantit la haute disponibilité.
    \item \textbf{Déploiement Indépendant :} Permet aux différentes équipes (ex: équipe Logistique vs équipe Partenaires) de déployer leurs évolutions sans risquer de générer des régressions sur les autres services.
  \end{itemize}
\end{frame}

\begin{frame}{Cartographie Logique du Système}
  \begin{center}
    \includegraphics[width=0.88\textwidth]{01_master_architecture.png}
  \end{center}
\end{frame}

% ======================================================================
% SECTION 3: DEEP DIVE
% ======================================================================
\section{3. Analyse des Services et Protocoles}

% -- SOAP --
\begin{frame}{\soapbadge~Service 1 : Approvisionnement (SOAP)}
  \begin{columns}[T]
    \begin{column}{0.48\textwidth}
      \textbf{Service :} Expose \texttt{SubmitOrder} pour centraliser les commandes.\\[0.6em]
      \textbf{Choix de SOAP :}
      \begin{itemize}
        \item \textbf{Intégrité Stricte (XSD) :} Le WSDL force l'arborescence et les types ("Fail-fast").
        \item \textbf{Interopérabilité Legacy :} S'intègre aux ERP industriels sans couche de traduction.
      \end{itemize}
      \vspace{0.4em}
      \footnotesize
      \begin{tabular}{p{3.2cm}p{3.2cm}}
        \gained{Garantie structurelle} & \sacrificed{Verbosité accrûe} \\
        \gained{Sécurité (WS-Sec)} & \sacrificed{Bande passante} \\
      \end{tabular}
    \end{column}
    \begin{column}{0.50\textwidth}
      \includegraphics[width=\textwidth]{02_soap_sequence.png}
    \end{column}
  \end{columns}
\end{frame}

% -- REST --
\begin{frame}{\restbadge~Service 2 : Stocks Routiques (REST)}
  \begin{columns}[T]
    \begin{column}{0.48\textwidth}
      \textbf{Service :} Gère l'inventaire via HTTP (\texttt{GET /inventory}, \texttt{PATCH /inventory/\{sku\}}).\\[0.6em]
      \textbf{Motivations du choix de REST :}
      \begin{itemize}
        \item \textbf{Accessibilité :} Standard du web fondé sur HTTP/JSON, facilitant l'intégration par les partenaires.
        \item \textbf{Notion de SKU :} Identifie un article unique en stock (ex: \textit{Stock Keeping Unit}). Idéal pour cibler un \texttt{PATCH} précis.
      \end{itemize}
      \vspace{0.4em}
      \footnotesize
      \begin{tabular}{p{3.2cm}p{3.2cm}}
        \gained{Cache HTTP natif} & \sacrificed{Typage dynamique} \\
        \gained{Interface intuitive} & \sacrificed{Sur-récupération} \\
      \end{tabular}
    \end{column}
    \begin{column}{0.50\textwidth}
      \includegraphics[width=\textwidth]{03_rest_sequence.png}
    \end{column}
  \end{columns}
\end{frame}

% -- GraphQL --
\begin{frame}{\graphqlbadge~Service 3 : Interface Reporting (GraphQL)}
  \begin{columns}[T]
    \begin{column}{0.48\textwidth}
      \textbf{Service :} Point d'entrée \texttt{/graphql} agrégeant magasins, employés et commandes.\\[0.6em]
      \textbf{Choix de GraphQL :}
      \begin{itemize}
        \item \textbf{Résout "N+1 Queries" :} Demande un arbre de données entier via une seule requête POST, évitant de multiplier les appels réseau HTTP.
        \item \textbf{"No Over-fetching" :} Le client spécifie uniquement les champs nécessaires pour l'interface UI.
      \end{itemize}
      \vspace{0.4em}
      \footnotesize
      \begin{tabular}{p{3.2cm}p{3.2cm}}
        \gained{Optimisation réseau} & \sacrificed{Implémentation dure} \\
        \gained{API Introspective} & \sacrificed{Cache inopérant} \\
      \end{tabular}
    \end{column}
    \begin{column}{0.50\textwidth}
      \includegraphics[width=\textwidth]{04_graphql_sequence.png}
    \end{column}
  \end{columns}
\end{frame}

% -- gRPC --
\begin{frame}{\grpcbadge~Service 4 : Télémétrie Automatisée (gRPC)}
  \begin{columns}[T]
    \begin{column}{0.48\textwidth}
      \textbf{Service :} Communication robotique \textit{Machine-to-Machine} à très haute fréquence.\\[0.6em]
      \textbf{Choix de gRPC :}
      \begin{itemize}
        \item \textbf{Efficience binaire :} Protobuf divise par 6 la taille du payload par rapport au JSON. Vital pour réseaux sans-fil (entrepôt).
        \item \textbf{Streaming Bidirectionnel :} HTTP/2 maintient la connexion ouverte, annulant la latence TCP ("Handshake") pour du temps-réel pur.
      \end{itemize}
      \vspace{0.4em}
      \footnotesize
      \begin{tabular}{p{3.2cm}p{3.2cm}}
        \gained{Faible latence pure} & \sacrificed{Format opaque} \\
        \gained{Génération de Stubs} & \sacrificed{Browsers inadaptés} \\
      \end{tabular}
    \end{column}
    \begin{column}{0.50\textwidth}
      \includegraphics[width=\textwidth]{05_grpc_sequence.png}
    \end{column}
  \end{columns}
\end{frame}

% ======================================================================
% TRANSITION TO TESTING
% ======================================================================
\begin{frame}{Validation Technique : Scénarios de Tests Pratiques}
  \textbf{Objectif de la phase de test :}
  Valider l'implémentation et l'intégration des 4 protocoles en conditions réelles, en sollicitant les serveurs déployés localement (via Postman et terminaux).

  \vspace{1em}
  \textbf{Périmètre de validation (Ce que nous allons exécuter et observer) :}
  \begin{itemize}
    \item \soapbadge~\textbf{Approvisionnement (SOAP)} : Envoi et validation d'une commande B2B via une enveloppe XML stricte (WSDL).
    \item \restbadge~\textbf{Stocks Boutiques (REST)} : Récupération d'un inventaire produit via une méthode HTTP GET classique en JSON.
    \item \graphqlbadge~\textbf{Pilotage (GraphQL)} : Agrégation de données complexes (Magasins + Commandes) en une seule trame POST ciblée.
    \item \grpcbadge~\textbf{Logistique (gRPC)} : Établissement d'un flux de streaming bidirectionnel (HTTP/2) affichant la télémétrie robotique en temps réel.
  \end{itemize}
\end{frame}

% ======================================================================
% SECTION 4: CROSS-PARADIGM ANALYSIS
% ======================================================================
\section{4. Étude Comparative}

\begin{frame}{Matrice décisionnelle : Orientations technologiques}
  \begin{center}
    \includegraphics[width=0.82\textwidth]{06_decision_tree.png}
  \end{center}
  \vspace{0.3em}
  \centering\small\textit{Postulat architectural initial : REST est l'approche par défaut. Toute déviation protocollaire doit être justifiée formellement par un manque capacitaire.}
\end{frame}

\begin{frame}{Analyse de surcharge d'encodage (Payload Overhead)}
  \begin{center}
    \includegraphics[width=0.85\textwidth]{08_payload_comparison.png}
  \end{center}
  \vspace{0.3em}
  \centering\small\textit{Pour modéliser le même objet de domaine : 1 KB (SOAP/XML) $\rightarrow$ 200 B (REST/JSON) $\rightarrow$ 50 B (gRPC/Protobuf).}
\end{frame}

\begin{frame}{Motif d'Architecture : Le Backend-For-Frontend (BFF) Aggregator}
  \begin{center}
    \includegraphics[width=0.82\textwidth]{07_aggregator_pattern.png}
  \end{center}
  \vspace{0.3em}
  \centering\small\textit{GraphQL agit comme un adaptateur agnostique : il consolide la complexité du paysage microservices, présentant une façade unifiée au client web.}
\end{frame}

% ======================================================================
% SECTION 5: CONCLUSION
% ======================================================================
\section{5. Conclusion et Améliorations}

\begin{frame}{Tableau comparatif entre les 4 API}
  \begin{table}
    \centering
    \scriptsize
    \renewcommand{\arraystretch}{1.3}
    \resizebox{\linewidth}{!}{%
    \begin{tabular}{l >{\color{soapblue}}c >{\color{restgreen}}c >{\color{graphqlpurple}}c >{\color{grpcorange}}c}
      \toprule
      \textbf{Attributs} & \textbf{SOAP} & \textbf{REST} & \textbf{GraphQL} & \textbf{gRPC} \\
      \midrule
      Couche Transport & HTTP/1.1 & HTTP/1.1 & HTTP/1.1 & HTTP/2 \\
      Sérialisation & XML & JSON & JSON & Binaire (Protobuf) \\
      Typage / Contrat & Statique Fort (XSD) & Faible (OpenAPI optionnel) & Fort (Schéma GraphQL) & Statique Fort (.proto) \\
      Modèle d'Exécution & Requête/Réponse & Requête/Réponse & Requête/Réponse (Graph) & Streaming Natif RPC \\
      Mécanique de Cache & Aucune & Native (GET HTTP) & Limité (POST HTTP) & Aucune \\
      Couplage Client & Important (Stubs WSDL) & Faible & Moyen & Important (Stubs gRPC) \\
      Cas d'Usage Cible & Transactions B2B & Opérations CRUD publiques & Agrégation de données UI & Télémétrie/Microservices internes \\
      \bottomrule
    \end{tabular}%
    }
  \end{table}
  \vspace{0.5em}
  \centering\small Il n'existe pas de standard API universel ("Silver Bullet"), uniquement des modélisations optimales pour des contraintes spécifiques.
\end{frame}

\begin{frame}{Point d'Amélioration : Implémentation d'une API Gateway}
  \textbf{Le périmètre actuel de l'étude (Scope Pédagogique) :}
  \begin{itemize}
    \item Exposition direct de 4 serveurs sur \textbf{4 ports disparates} (8001, 8002, 8003, 50051).
    \item Permet l'étude isolée de chaque serveur, mais viole les bonnes pratiques de sécurité et de routage en environnement d'intégration.
  \end{itemize}
  
  \vspace{1em}
  
  \textbf{Évolution cible en production :}
  \begin{itemize}
    \item Déploiement d'une \textbf{Passerelle d'API (API Gateway)}, comme Kong ou AWS Gateway.
    \item La passerelle agit comme reverse proxy de niveau \textbf{L7 (Couche Application)}, exposant un port d'entrée unifié (ex: 443 pour TLS).
    \begin{itemize}
      \item \texttt{/api/procurement} $\rightarrow$ Routé vers le cluster SOAP interne.
      \item \texttt{/api/inventory} $\rightarrow$ Routé vers le cluster REST interne.
    \end{itemize}
    \item Résultat : Abstraction totale de l'architecture distribuée sous-jacente pour les consommateurs finaux, et centralisation des fonctions de sécurité (Authentification, Rate-Limiting).
  \end{itemize}
\end{frame}

\begin{frame}{Synthèse Finale}
  \begin{enumerate}
    \item \textbf{Cohérence Fonctionnelle/Technique} : L'approche protocolaire doit toujours être subordonnée aux exigences fonctionnelles du domaine (ex. haute-fréquence logistique vs accessibilité partenaire).
    \item \textbf{Primauté de REST} : Demeure le standard \textit{de facto} pour l'interopérabilité large, particulièrement pour des architectures orientées ressources (CRUD).
    \item \textbf{Design Contract-Driven} : Établir des contrats (OpenAPI, WSDL, Protobuf) est un prérequis indispensable à la décentralisation des développements en architecture microservices.
    \item \textbf{Synergie REST/GraphQL} : GraphQL ne déprécie pas REST. Il l'enrichit en se positionnant comme une couche d'agrégation d'expérience (\textit{Backend-For-Frontend}) optimisée réseau.
    \item \textbf{Avantage comparatif gRPC} : L'utilisation de protocoles multiplexés (HTTP/2) compacts (Protobuf) s'avère indispensable en contexte IOT et M2M pour prévenir la saturation réseau.
  \end{enumerate}
  \vspace{0.5em}
\end{frame}

% ======================================================================
% THANK YOU
% ======================================================================
\begin{frame}[plain]
  \centering
  \vspace{2em}
  {\LARGE\textbf{Merci pour votre attention !}}\\[1.5em]
  {\large Avez-vous des questions ?}\\[2em]
  \soapbadge~\texttt{:8001}\quad
  \restbadge~\texttt{:8002}\quad
  \graphqlbadge~\texttt{:8003}\quad
  \grpcbadge~\texttt{:50051}\\[2em]
  {\footnotesize\texttt{github.com/AyaMor/omnichain-retail-mesh}}
\end{frame}

\end{document}
